<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login / Sign Up</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <h2>Login / Register</h2>
    <div id="authSection">
        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="Password" />
        <div class="button-group">
            <button onclick="signUp()">Sign Up</button>
            <button onclick="logIn()">Log In</button>
            <button onclick="logOut()">Log Out</button>
        </div>
        <p id="userDisplay"></p>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD9HYugj4J__u_nILLwHXj91WPxsZipsVo",
            authDomain: "test-app-fc997.firebaseapp.com",
            databaseURL: "https://test-app-fc997-default-rtdb.firebaseio.com",
            projectId: "test-app-fc997",
            storageBucket: "test-app-fc997.appspot.com",
            messagingSenderId: "913295044562",
            appId: "1:913295044562:web:7b46d7223a6e109d79220b",
            measurementId: "G-3GX4JBEQ2Z"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        function logIn() {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log("Login successful:", userCredential.user.email);
                    window.location.href = "shop.html";
                })
                .catch((e) => {
                    console.error("Login error:", e.message);
                    alert(e.message);
                });
        }

        function signUp() {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log("Signup successful:", userCredential.user.email);
                    window.location.href = "shop.html";
                })
                .catch((e) => {
                    console.error("Signup error:", e.message);
                    alert(e.message);
                });
        }

        function logOut() {
            auth.signOut()
                .then(() => {
                    alert("Logged out successfully");
                    document.getElementById("userDisplay").innerText = "Not logged in";
                });
        }

        // Show user status on load
        auth.onAuthStateChanged((user) => {
            const display = document.getElementById("userDisplay");
            if (user) {
                display.innerText = `Logged in as: ${user.email}`;
            } else {
                display.innerText = "Not logged in";
            }
        });
    </script>
</body>

</html>